C       COPYRIGHT       NONE.  THIS CODE IS IN THE PUBLIC DOMAIN.
C       FILENAME        GEMINICATCHUPANDRENDEZVOUSPROGRAM/MAIN7.F
C       PURPOSE         THIS IS PART OF THE ORIGINAL 1965 SIMULATION
C                       PROGRAM FOR THE GEMINI 7/6 MISSION
C                       CATCH-UP AND RENDEZVOUS FLIGHT PHASES.
C                       THIS PARTICULAR FILE IS THE MAIN FILE FOR
C                       PROGRAM MAIN7 (ENVIRONMENT), BY FERNEY HOUGH
C                       OF IBM OWEGO, WITH VARIOUS SUBROUTINES
C                       APPEARING IN SEPARATE SOURCE FILES.
C       WEBSITE         WWW.IBIBLIO.ORG/APOLLO (ALL LOWER CASE, PLEASE)
C       HISTORY         2010-08-12 RSB  BEGAN TRANSCRIBING FROM
C                                       THE SCANNED PDF REPORT.
C
C       THE FOLLOWING COMMENTS APPLY NOT ONLY TO THIS SOURCE FILE, BUT
C       TO ALL SOURCE FILES WITHIN THE PARENT FOLDER.
C
C       THIS SOURCE CODE WAS MANUALLY ENTERED BY READING THE SCANNED
C       PDF FILE GEMINI CATCH-UP AND RENDEZVOUS ANALYSIS AND SIMULATION
C       REPORT 4, DATED DECEMBER 31, 1965, PRESERVED BY EUGENE
C       MERTZ AND SCANNED BY DAVE MERTZ. (REFER TO THE WEBSITE LINK
C       ABOVE FOR THE FULL DOCUMENT.)  THE SOURCE FILE THEN UNDERWENT
C       EXTENSIVE PROOFING.
C
C       THE PROGRAM ITSELF APPEARS TO BE WRITTEN IN FORTRAN II, INTERMIXED
C       WITH ASSEMBLY LANGUAGE FOR THE IBM 7090/7094 MAINFRAME ON WHICH
C       IT RAN.  IT THEREFORE CANNOT BE MEANINGFULLY COMPILED AS-IS WITH
C       ANY MODERN FORTRAN COMPILER.  NOTE, HOWEVER, THE EXISTENCE OF AN
C       IBM 7090/7094 SIMULATOR ON WHICH IT MAY BE POSSIBLE TO RUN AN
C       UNMODIFIED VERSION OF THIS PROGRAM. MODIFIED VERSIONS OF THE
C       PROGRAM WHICH CAN BE COMPILED WITH (FOR EXAMPLE) GNU FORTRAN
C       WILL BE PROVIDED AT VIRTUAL AGC PROJECT WEBSITE AS THEY BECOME
C       AVAILABLE.
C
C       TO A CERTAIN EXTENT, IT HAS BEEN POSSIBLE TO PERFORM SOME SYNTAX
C       CHECKING OF THE FORTRAN SOURCE FILES BY COMPIING WITH FORTRAN 66
C       (I.E., USING THE GNU FORTRAN COMPILER G77 WITH THE APPROPRIATE
C       COMMAND-LINE SWITCHES.)  IN ORDER TO DO THIS, IT IS NECESSARY
C       TO TEMPORARILY REMOVE THE PARAMETRIZED LIST OF SWITCH SETTINGS
C       WHICH ACCOMPANY END-STATEMENTS.
C
C       THE ORIGINAL CODE HAS BEEN PRESERVED AS FAR AS IT HAS BEEN POSSIBLE
C       FOR ME TO DO SO, INCLUDING POSITIONING OF WHITE-SPACE, EXCEPT FOR
C       THE FOLLOWING --
C       1. A HEADER COMMENT BLOCK (SUCH AS THIS ONE) HAS BEEN ADDED TO
C          EACH SOURCE FILE.
C       2. COMMENTS HAVE BEEN ADDED TO SHOW HOW THE SOURCE CODE ALIGNS
C          TO THE PAGE BREAKS IN THE REPORT FROM WHICH THE SOURCE WAS
C          TAKEN.
C       3. ALL LINE LABELS ARE ALIGNED AT COLUMN 2. FORTRAN II WAS
C          INSENSITIVE TO THE POSITIONING, AS LONG AS THE ENTIRE LABEL
C          WAS CONFINED TO COLUMNS 2-7, BUT THE FORTRAN 66 COMPILER I
C          AM USING FOR CHECKING IS NOT INSENSITIVE TO THE ALIGNMENT.
C       4. CONTINUATION CHARACTERS IN COLUMN 8 HAVE BEEN REPLACED BY
C          1 WHEN * WAS ORIGINALLY USED, AGAIN BECAUSE THE FORTRAN 66
C          COMPILER DOES NOT ACCEPT *.
C       5. SOME LINES WHICH WERE BROKEN INTO TWO BY CONTINUATIONS IN WAYS
C          NOT RECOGNIZED BY THE THE FORTRAN 66 COMPILER HAVE BEEN
C          INSTEAD BROKEN AT DIFFERENT POINTS.
C       ALL ADDED COMMENTS CONFINE THEMSELVES TO THE FORTRAN II
C       CHARACTER-SET, WHICH IS VERY LIMITED (UPPER-CASE ONLY, VARIOUS
C       PUNCTUATION MARKS MISSING). THIS UNFORTUNATELY MEANS THAT LISTED
C       FILENAMES AND WEB-LINKS ARE TYPICALLY INCORRECT.  THIS IS WHY,
C       FOR EXAMPLE, THERE IS NO WEB-LINK PROVIDED FOR THE IBM 7090/7094
C       SIMULATOR SOFTWARE -- THE CHARACTERS IN THE LINK WOULD BE ILLEGAL.
C
C       THE ORIGINAL SOURCE CODE'S COMMENTS ARE RETAINED, BUT THEY WERE
C       FEW AND FAR-BETWEEN.  TO UNDERSTAND THE CODE, IT NEEDS TO BE
C       COMPARED WITH EXTERNAL DOCUMENTATION SUCH AS THE ORIGINAL REPORT.
C       PAGE NUMBERS IN THE ADDED COMMENTS REFER TO THE PAGES IN THE PDF
C       FILE AND NOT TO PAGE NUMBERING PRINTED ON THE ORIGINAL HARDCOPY OF
C       THE REPORT.
C
C       FROM PAGE 69 OF THE REPORT 
        DIMENSION CXT(11),CYT(11),CZT(11),CDTWT(11),VLIST(1),DLIST(100),
       1ILIST(100),SLIST(100),TLIST(100)
        DIMENSION REM(165),ITH(10),SC(14),TARG(14),TABLE1(50,20),
       1PSLST(50),IPLST(50),RKK(50)
        COMMON CDVXSP,CDVYSP,CDVZSP,CDPHSC,CDPSSC,CDTHSC,AKX1  ,AKX2  ,
       1AKX3  ,AKX4  ,AKYI  ,AKY2  ,AKY3  ,AKY4  ,AKZI  ,AKZ2  ,AKZ3  ,
       2AKZ4  ,ASFX  ,ASFY  ,ASFZ  ,CO    ,COI   ,C2    ,C2I   ,CA11  ,
       3CA12  ,CAI3  ,CA21  ,CA22  ,CA23  ,CA31  ,CA32  ,CA33  ,CAPT  ,
       4CAPTI ,CATXBA,CATXBI,CCAB  ,CCABI ,CCAS  ,CCAS1 ,CCK1  ,CCK2  ,
       5CCK3  ,CCK4  ,CCKS  ,CCKF  ,CCKG  ,CCPHIB,CCPSIB,CCPSIR,CCR   ,
       6CCRB  ,CCRBI ,CCRI  ,CCRS  ,CCRSI ,CCTHB ,CCTHR ,CCWSTD,CCWTOL,
       7CCZT  ,CDEL  ,CDRRD ,CDTM  ,CDTW  ,CDTWT ,CDTWX ,CDTX  ,CDV   ,
       8CDVF  ,CDVI  ,CDVT  ,CDVXB ,CDVXM ,CDVXS ,CDVXZ ,CDVYB ,CDVYM ,
       9CDVYS ,CDVYZ ,CDVZB ,CDVZM ,CDVZS ,CDVZZ ,CDXD  ,CDXFD ,CDYD
        COMMON CDYFD ,CDZD  ,CDZFD ,CFX   ,CFY   ,CFZ   ,CM1   ,CM3   ,
       1CM4   ,CM5   ,CM6   ,CNPC  ,CNS   ,CNVX  ,CNVY  ,CNVZ  ,CNYC  ,
       2COEFF ,COINT ,COMGS ,CPHIB ,CPHIBC,CPSBCP,CPSIB ,CPSIBC,CPSIBM,
       3CR1   ,CRA   ,CRLO  ,CRR   ,CRRD  ,CRRG  ,CRRI  ,CRRPI ,CRS   ,
       4CSADPI,CSAPG ,CSAPI ,CSAPR ,CSPHIB,CSPSIB,CSPSIR,CSRDPI,CSRPG ,
       5CSRPI ,CSRPR ,CSRT  ,CSRTI ,CSTD  ,CSTOL ,CSTHB ,CSTHR ,CSTZ  ,
       6CSWSTD,CSWTDL,CT    ,CTD   ,CTDAS ,CTDV  ,CTHB  ,CTHBC ,CTHBCP,
       7CTHBM ,CTLRP ,CTM   ,CTR1  ,CTRR  ,CTTG  ,CTW   ,CTX   ,CUDPHS,
       8CUDPSS,CUDTHS,CWSTD ,CWSTDL,CWTTPR,CX    ,CXM   ,CXRD  ,CXSD  ,
       9CXT   ,CXTD  ,CXZ   ,CY    ,CYM   ,CYRD  ,CYSD  ,CYT   ,CYTD
        COMMON CYZ   ,CZ    ,CZM   ,CZRD  ,CZSD  ,CZT   ,CZTD  ,CZZ   ,
       1DELAY ,DONPRT,DT    ,DUM1  ,DUM2  ,DUM3  ,DUM4  ,DUM5  ,DUM6  ,
       2DUM7  ,DUM8  ,DUM9  ,DUM10 ,DUM11 ,DUM12 ,DUM13 ,DUM14 ,DUM15 ,
       3DUM16 ,DUMI7 ,DUMI8 ,FIN   ,FP    ,FXP   ,FXPP  ,FYP   ,FYPP  ,
       4FZP   ,FZPP  ,GC    ,IC    ,IEXIT ,IOLP  ,IWRITE,K2C   ,KC    ,
       5KWRITE,L     ,LC1   ,LC1J  ,LC2   ,LC3   ,LC4A  ,LC4B  ,LC4C  ,
       6LC4D  ,LC4E  ,LC4F  ,LC4G  ,LC5   ,LC7   ,LC8   ,LC10  ,LCA   ,
       7LCS   ,LCY   ,LDI00 ,LDI10 ,LDI11 ,LDI13 ,LDI20 ,LDI21 ,LDI22 ,
       8LDI25 ,LDI26 ,LDI31 ,LDO01 ,LDO05 ,LDO11 ,LDO12 ,LDO13 ,LDO62 ,
       9LDO63 ,LFDI  ,LQT   ,M     ,N     ,PHIB  ,PINT  ,PSIB  ,RDGD
        COMMON RRDREF,SRAA  ,SREA  ,SW    ,TEST  ,TFTXV ,TFTYV ,TFTZV ,
       1THETAB,TIME  ,TPC   ,TRI   ,TSC   ,TVX   ,TVY   ,TVZ   ,TYC   ,
       2XGRT  ,XGRTD ,XKRDR ,YGRT  ,YGRTD ,ZGRT  ,ZGRTD
        EQUIVALENCE (DELVX,CDVXSP),(DELVY,CDVYSP),(DELVZ,CDVZSP),
       1(CDPHSC,DPHIB),(CDPSSC,DPSIB),(CDTHSC,DTHB),(VLIST,CDVXSP)
        EQUIVALENCE   (XI  ,SC( 1)),(YI  ,SC( 2)),(ZI  ,SC( 3)),
       1(TI  ,SC( 4)),(DXI ,SC( 5)),(DYI ,SC( 6)),(DZI ,SC( 7)),
       2(SCVM,SC( 8)),(RJ  ,SC( 9)),(DTT ,SC(10)),(Q37 ,SC(11)),
       3(Q38 ,SC(12)),(Q39 ,SC(13))
        EQUIVALENCE     (XTI ,TARG( 1)),(YTI ,TARG( 2)),(ZTI ,TARG( 3)),
       1(TTI ,TARG( 4)),(DXTI,TARG( 5)),(DYTI,TARG( 6)),(DZTI,TARG( 7)),
       2(TVM ,TARG( 8)),(RJJ ,TARG( 9)),(DTTP,TARG(10))
        EQUIVALENCE    (A11 ,RKK(50)),(A12 ,RKK(49)),(A13 ,RKK(48)),
       1(A21 ,RKK(47)),(A22 ,RKK(46)),(A23 ,RKK(45)),(A31 ,RKK(44)),
       2(A32 ,RKK(43)),(A33 ,RKK(42)),(DA11,RKK(41)),(DA12,RKK(40)),
       3(DA13,RKK(39)),(DA21,RKK(38)),(DA22,RKK(37)),(DA23,RRK(36)),
       4(DA31,RKK(35)),(DA32,RKK(34)),(DA33,RKK(33))
        ZZ1=CLOCKF(XX)
        CALL HDA7
        CALL SELFLD
        KT1= 5
C
C       FROM PAGE 70 OF THE REPORT 
        KT2= 9
        KT3= 14
        CALL LDB6
        READ INPUT TAPE KT1,1032,(REM(I),I1,165)
 330    ZZ2=CLOCKF(XX)
        DO 331  I=  1, 20
        DO 331  J= 1,50
 331    TABLE1(J,I)=0.
        DO 332 I=  1, 50
 332    RKK(I)=0.
        DO 333 I= 1,14
        SC(I)  =0.
 333    TARG(I)=0.
        DO 334 I= 1,331
 334    VLIST(I)=0.
        READ INPUT TAPE KT1,1010,NDATE1,NDATE2,NDATE3,NRUN1,NRUN2
        READ INPUT TAPE KTI,1002,   EOP   ,STCT  ,CTZ   ,CTE   ,COINT ,
       1DELAY ,ESPR  ,DT    ,BINT  ,CAPT  ,COMGT ,CSRT  ,XI    ,YI    ,
       2ZI,   ,DXI   ,DYI   ,DZI   ,XTI   ,YTI   ,ZTI   ,DXTI  ,DYTI  ,
       3DZTI  ,RJ    ,CATXBA,CATXFW,CATYB ,CATZB ,XKRDR ,CCAB  ,CCAS  ,
       4CCRB  ,CCRS  ,C0    ,C2    ,A11   ,A12   ,A13   ,A21   ,A22   ,
       5A23   ,A31   ,A32   ,A33   ,AKX1  ,AKX2  ,AKX3  ,AKX4  ,AKY1  ,
       6AKY2  ,AKY3  ,AKY4  ,AKZ1  ,AKZ2  ,AKZ3  ,AKZ4  ,XKP1  ,XKP2  ,
       7XKP3  ,XKR   ,XKY   ,CCR
        READ INPUT TAPE KT1,1001,(ITH(I),I=1,10) ,MACOP ,MACNTR,MACINT,
       1MODCR ,NPF   ,LOC   ,LMDI
        READ INPUT TAPE KT1,1012,          LFP   ,LGANG ,LRR   ,LSRA  ,
       1LRM   ,LDB   ,LFDI, ,IEXIT
        READ INPUT TAPE KT1,1005,KEYSET
 57     CALL KEYCN (KOMBO)
        IF (KEYSET-KOMBO) 58,59,58
 58     PRINT 1017,KEYSET
        PAUSE
        GO TO 57
 59     WRITE OUTPUT TAPE KT2,1037, EOP   ,STCT  ,CTZ   ,CTE   ,COINT ,
       1DELAY ,ESPR  ,DT    ,BINT  ,CAPT  ,COMGT ,CSRT  ,XI    ,YI    ,
       2ZI    ,DXI   ,DYI   ,DZI   ,XTI   ,YTI   ,ZTI   ,DXTI  ,DYTI  ,
       3DZTI  ,RJ    ,CATXBA,CATXFW,CATYB ,CATZB ,XKRDR
        WRITE OUTPUT TAPE KT2,1038, CCAB  ,CCAS  ,CCRB  ,CCRS  ,C0    ,
       2C2    ,A11   ,A12   ,A13   ,A21   ,A22   ,A23   ,A31   ,A32   ,
       2A33   ,AKX1  ,AKX2  ,AKX3  ,AKX4  ,AKY1  ,AKY2  ,AKY3  ,AKY4  ,
       3AKZ1  ,AKZ2  ,AKZ3  ,AKZ4  ,XKP1  ,XKP2  ,XKP3
        WRITE OUTPUT TAPE KT2,1039, XKR   ,XKY   ,CCR
        WRITE OUTPUT TAPE KT2,1040,(ITH(I),I=1,10),MACOP ,MACNTR,MACINT,
       1MODCR ,NPF   ,LOC   ,LMDI  ,LFP   ,LGANG ,LRR   ,LSRA  ,LRM   ,
       2LDB   ,LFDI  ,IEXIT
        WRITE OUTPUT TAPE KT2,1011,NDATE1,NDATE2,NDATE3,NRUN1,NRUN2
        PRINT 1013,NOATE1,NDATE2,NDATE3,NRUN1,NRUN2
        IF (LMDI) 115,125,115
 115    IPL=0
 108    IPL=IPL+1
        IF(IPL-100) 116,116,109
 116    READ INPUT TAPE KT1,1050,SLIST(IPL),TLIST(IPL),DLIST(IPL),
       1ILIST(IPL
        IF(ILIST(IPL)) 108,109,108
 109    JK=IPL
C
C       FROM PAGE 71 OF THE REPORT 
        WRITE OUTPUT TAPE KT2,1051
        DO 113 I=1,JK
 113    WRITE OUTPUT TAPE KT2,1052,SLIST(I),TLIST(I),DLIST(I),ILIST(I)
 125    IF (LOC) 252,94,252
 252    READ INPUT TAPE KT1,1014,LIMIT,(PSLST(LPL),IPLST(LPL),LPL=1,2)
        IF (LIMIT-2) 903,903,251
 251    READ INPUT TAPE KT1,1015,(PSLST(LPL),IPLST(LPL),LPL=3,LIMIT)
 903    WRITE OUTPUT TAPE KT2,1016,(PSLST(LPL),IPLST(LPL),LPL=1,LIMIT)
        CALL HDA9
 94     IF (MACOP) 95,96,95
 95     RT= ZTI
        RAD=.01745329
        THT=XTI*RAD
        PHT=YTI*RAD
        GAT=DXTI*RAD
        PST=YTI*RAD
        CTHT=COSF(THT)
        STHT=SINF(THT)
        CPHI=COSF(PHT)
        SPHT=SINF(PHT)
        XTI=RT*CTHT*CPHT
        YTI=RT*STHT*CPHT
        ZTI=RT*SPHT
        CGAT=COSF(GAT)
        SGAT=SINF(GAT)
        CPST=COSF(PST)
        SPST=SINF(PST)
        DXTI=DZTI*(CTHT*(CPHT*SGAT-SPHT*CPST*CGAT)-STHT*SPST*CGAT)
        DYTI=DZTI*(STHT*(CPHT*SGAT-SPHT*CPST*CGAT)+CTHT*SPST*CGAT)
        DZTI=DZTI*(SPHT*SGAT+CPHT*CPST*CGAT)
        RDT=(XTI*DXTI+YTI*DYTI+ZTI*DZTI)/RT
        IF(MACNTR)98,97,98
 98     RF=YI +RT
        AZTF=ATN1F(ZI ,RT)
        AXTF=XI /RT
        SINX=SINF(AXTF)
        COSX=COSF(AXTF)
        SINZ=SINF(AZTF)
        COSZ=COSF(AZTF)
        PHX=ARSINF(COSX*SPHT-SINX*CPHT*CPST)
        SPHX =SINF(PHX)
        CPHX =COSF(PHX)
        DTHX=ARSINF(SINX*SPST/CPHX)
        THX =THT    -DTHX
        PSX1 =COSF(DTHX)*CPST
        PSX2 =SINF(DTHX)*SPST*SPHT
        IF(XI ) 28,28,29
 29     PSX=ARCOSF(PSX1+PSX2)
        GO TO 30
 28     PSX=ARCOSF(-PSX1+PSX2)
 30     PHF=ARSINF(COSZ*SPHX+SINZ*CPHX*SINF(PSX))
        DTHF=ARSINF(SINZ*COSF(PSX)/COSF(PHF))
        THF =THX-DTHF
        U233 =PHF/RAD
        U234 =THF/RAD
        ZI=RF*SINF(PHF)
C        
C       FROM PAGE 72 OF THE REPORT 
        XI=RF*COSF(PHF)*COSF(THF)
        YI=RF*COSF(PHF)*SINF(THF)
        SF=YTI*DZTI-ZTI*DYTI
        SG=ZTI*DXTI-XTI*DZTI
        SH=XTI*DYTI-YTI*DXTI
        SJ=SQRTF(SF**2+SG**2+SH**2)
        HT=SJ/RT
        BOB1=ZTI*SG-YTI*SH
        BOB2=XTI*SH-ZTI*SF
        BOB3=YTI*SF-XTI*SG
        BOBL= SQRTF(BOB1**2+BOB2**2+BOB3**2)
        P= BOB3*YI-BOB2*ZI
        Q= BOB1*ZI-BOB3*XI
        S= BOB2*XI-BOB1*YI
        BIGD=2.E-8*(-SJ*RF**2/RT)*(DXI -RDT*AXTF-HT)
        BIGE=2.E-8*RF*(DYI +RDT)
        BIGF=2.E-8*RF*BOBL*DZI
        BIGA=2.E-8*SG*ZI-2.E-8*SH*YI
        BIGB=2.E-8*SH*XI-2.E-8*SF*ZI
        BIGC=2.E-8*SF*YI-2.E-8*SG*XI
        DEL= BIGA*YI*(4.E-16*S) + BIGB*ZI*(4.E-16*P) + BIGC*XI*(4.E-16*Q)
       1   - BIGC*YI*(4.E-16*P) + BIGB*XI*(4.E-16*S) - BIGA*ZI*(4.E-16*Q)
        C11= YI*(4.E-16*S) - ZI*(4.E-16*Q)
        C21= BIGB*(2.E-8*S) - BIGC*(2.E-8*Q)
        C22= BIGA*(2.E-8*S) - BIGC*(2.E-8*P)
        C31= 2.E-8*(BIGB*ZI-BIGC*YI)
        C12= XI*(4.E-16*S) - ZI*(4.E-16*P)
        C32= 2.E-8*(BIGA*ZI-BIGC*XI)
        C13= XI*(4.E-16*Q) - YI((4.E-16*P)
        C23= BIGA*(2.E-8*Q) - BIGB*(2.E-8*P)
        C33= 2.E-8*(BIGA*YI-BIGB*XI)
        DELD=BIGD/DEL
        DELE=BIGE/DEL
        DELF=BIGF/DEL
        DZI=C13*DELD-C23*DELE+C33*DELF
        DYI=-C12*DELD+C22*DELE-C32*DELF
        DXI=C11*DELD-C21*DELE+C31*DELF
        GO TO 96
 97     CTHF =COSF (XI  *RAD)
        STHF =SINF (XI  *RAD)
        CPHF =COSF( YI  * RAD)
        SPHF= SINF (YI  * RAD)
        XI=ZI *CTHF * CPHF
        YI=ZI *STHF * CPHF
        ZI=ZI *SPHF
        CGAF = COSF(DXI* RAD)
        SGAF =SINF(DXI* RAD)
        CPSF= COSF(DYI * RAD)
        SPSF= SINF (DYI * RAD)
        DXI=DZI   * (CTHF*(CPHF * SGAF- SPHF*CPSF*CGAF)- STHF*SPSF *CGAF)
        DYI=DZI  * (STHF *(CPHF* SGAF-SPHF* CPSF* CGAF)+ CTHF *SPSF* CGAF)
        DZI=DZI   *(SPHF * SGAF +CPHF * CPSF*CGAF)
 96     TI=SQRTF(XI**2+YI**2+ZI**2)
        TTI=SQRTF(XTI**2+YTI**2+ZTI**2)
        RJJ=RJ
        IF (MACINT) 995,996,995
C        
C       FROM PAGE 73 OF THE REPORT 
 995    DXI=-DXI
        DYI=-DYI
        DZI=-DZI
        DXTI=-DXTI
        DYTI=-DYTI
        DZTI=-DZTI
        DTT=10.*DT
        DTTP=DTT
 990    CALL STATE (SC)
        CALL STATE (TARG)
        T=T+DTT
 992    IF (T-BINT)  990,989,989
 989    WRITE OUTPUT TAPE KT2,642,T,NDATE1,NDATE2,NDATE3,NRUN1,NRUN2
        WRITE OUTPUT TAPE KT2,643,XI,YI,ZI
        WRITE OUTPUT TAPE KT2,644,DXI,DYI,DZI
        WRITE OUTPUT TAPE KT2,645,XTI,YTI,ZTI
        WRITE OUTPUT TAPE KT2,644,DXTI,DYTI,DZTI
        DXI=-DXI
        DYI=-DYI
        DZI=-DZI
        DXTI=-DXTI
        DYTI=-DYTI
        DZTI=-DZTI
 996    T=CTZ
        KPLOT= 0
        MUD5=0
 851    ZZ=CLOCKF(XX)
        PRINT 1004
        CO=CTZ
        XLIMIT=.20
        GC=1.407654E+16
        RE=2.0925874E+07
        ICC=1
        JUMP=0
        LDI22=0
        MM=0
        IPL=1
        ITAG=0
        INPASS=0
        INITAL=0
        TRIDOT=0.
 553    IF (MODCR-1) 554,555,102
 554    LDI10=0
        LDI11=4095
        LDI13=0
        GO TO 102
 555    LDI10=4095
        LDI11=0
        LDI13=4095
        GO TO 102
 101    DTT=DT
        DTTP=DTT
        CALL STATE (SC)
        CALL STATE (TARG)
        T=T+DTT
 102    TIME =T
C    
C       FROM PAGE 74 OF THE REPORT 
        IF (ITH(ICC)) 71,72,71
 71     DXPFO=P11*Q37+P21*Q38+P31*Q39
        DYPFO=P12*Q37+P22*Q38+P32*Q39
        DZPFO=P13*Q37+P23*Q38+P33*Q39
        FXP=FXP+DXPFO*DT
        FYP=FYP+DYPFO*DT
        FZP=FZP+DZPFO*DT
        FXP1=FXP
        FYP1=FYP
        FZP1=FZP
        TFTXV=TFTXV+ABSF(FTXV)*DT
        TFTYV=TFTYV+ABSF(FTYV)*DT
        TFTZV=TFTZV+ABSF(FTZV)*DT
 72     OMEGA=ATN1F((DZI*YI-DYI*ZI),(DZI*XI-DXI*ZI))
        Q30=SINF(OMEGA)
        Q31=COSF(OMEGA)
        OIOTA=ARCOSF((DYI*XI-DXI*YI)/(TI*SCVM))
        OMU=ARCOSF((XI*Q32+YI*Q30)/TI)
        IF (ZI) 700,704,704
 700    OMU=-OMU
 704    Q32=SINF(OMU)
        Q33=COSF(OMU)
        Q34=SINF(OIOTA)
        Q35=COSF(OIOTA)
        P11=-Q32*Q31-Q33*Q30*Q35
        P12=-Q33*Q31+Q32*Q30*Q35
        P13=Q34*Q30
        P21=Q33*Q31*Q35-Q32*Q30
        P22=-Q33*Q30-Q32*Q31*Q35
        P23=-Q31*Q34
        P31=Q33*Q34
        P32=-Q32*Q34
        P33=Q35
        PB11=A11*P11+A21*P21+A31*P31
        PB12=A11*P12+A21*P22+A31*P32
        PB13=A11*P13+A21*P23+A31*P33
        PB21=A12*P11+A22*P21+A32*P31
        PB22=A12*P12+A22*P22+A32*P32
        PB23=A12*P13+A22*P23+A32*P33
        PB31=A13*P11+A23*P21+A33*P31
        PB32=A13*P12+A23*P22+A33*P32
        PB33=A13*P13+A23*P23+A33*P33
        PHIB=ATN1F(PB33,-PB23)
        THETAB=ATN1F(-PB12,PB11)
        Q82=ABSF(SINF(PHIB))
        IF(Q82-.4)601,601,602
 601    PSIB=ATN1F(-PB13,-PB23/COSF(PHIB))
        GO TO 603
 602    PSIB=ATN1F(-PB13,PB33/SINF(PHIB))
 603    CONTINUE
        IF (LDO05) 551,552,551
 551    SENSE LIGHT 4
        GO TO 556
 552    IF(SENSE LIGHT 4) 556,556
 556    IF(LDI 21) 114,428,114
 428    CALL KEYS (17,KEY17)
C    
C       FROME PAGE 75 OF THE REPORT 
        IF (KEY17) 427,300,427
 427    LDI21=2047
        TSC=T
        GO TO 114
 300    IF (T-STCT) 114,110,100
 110    LDI21=4095
        TSC=T
 114    IF(LMDI) 104,111,104
 104    IF(T-TLIST(IPL))111,105,105
 105    K=ILIST(IPL)
        IF(LMDI) 107,106,106
 106    VLIST(K)=DLIST(IPL)
        GO TO 117
 107    CALL INSERT (ILIST(IPL),DLIST(IPL),SLIST(IPL))
 117    IPL=IPL+1
 118    IF(K-288) 204,119,104
 119    IF(LDI21) 122,104,122
 122    TSC=T
        GO TO 104
 111    XRI=XTI-XI
        YRI=YTI-YI
        ZRI=ZTI-ZI
        TRI=SQRTF(XRI**2+YRI**2+ZRI**2)
 126    IF(INPASS) 127,128,127
 127    TRIDOT=(TRI-TRI1)/DT
 128    TRI1=TRI
 767    XRV=A11*XRI+A21*YRI+A31*ZRI
        YRV=A12*XRI+A22*YRI+A32*ZRI
        ZRV=A13*XRI+A23*YRI+A33*ZRI
        RAA=6.28318530-ATN1F(YRV,SQRTF(XRV**2+ZRV**2))
        IF (RAA-25./57.2957795) 761,761,762
 762    IF (RAA-335./57.2957795) 763,761,761
 761    SRAA=(SINF(RAA)-CCRB)/(1.+CCRS)
        REAPR=SQRTF(XRV**2+YRV**2)
        REA=ATN1F(ZRV,SIGNF(REAPR,XRV))
        IF (REA-25./57.2957795) 764,764,765
 765    IF (REA-335./57.2957795) 763,764,764
 764    SREA=(SINF(REA)-CCAB)/(1.+CCAS)
 197    IF (ABSF(WXV   )-.02618) 768,768,763
 768    IF (ABSF(WYV   )-.02618) 769,769,763
 769    IF (ABSF(WZV   )-.02618) 766,766,763
 766    IF(LQT) 763,448,763
 448    LDI00=4095
        GO TO 449
 763    LDI00=0
 449    IF(LFDI) 450,455,450
 450    IF(LDI21) 451,454,451
 451    IF(CTX-200.) 456,452,452
 452    IF(LDO05) 453,456,453
 455    IF(CRLO) 450,456,450
 453    IF(LDI00) 454,456,454
 454    LRDFDI=4095
        GO TO 787
 456    LRDFDI=0
 787    RADTD=(XTI*DXTI+YTI*DYTI+ZTI*DXTI)/TTI
        GAMT=ARSINF(RADTD/TVM)
C
C       FROM PAGE 76 OF THE REPORT 
        THET=ATN1F(YTI,XTI)
        PHIT=ARSINF(ZTI/TTI)
        PSIT=ATN1F((XTI*DYTI-YTI*DXTI),(TTI *DZTI-ZTI*RADTD)
        STHET=SINF(THET)
        CTHET=COSF(THET)
        SPHIT=SINF(PHIT
        CPHIT=COSF(PHIT)
        SPSIT=SINF(PSIT)
        CPSIT=COSF(PSIT)
        T11=STHET*SPSIT+CTHET*CPSIT*SPHIT
        T12=CPHIT*CTHET
        T13=STHET*CPSIT-CTHET*SPSIT*SPHIT
        T21=-CTHET*SPSIT+STHET*CPSIT*SPHIT
        T22=CPHIT*STHET
        T23=-CTHET*CPSIT-STHET*SPSIT*SPHIT
        T31=-CPHIT*CPSIT
        T32=SPHIT
        T33=CPHIT*SPSIT
        XP=T11*XI+T21*YI+T31*ZI
        YP=T12*XI+T22*YI+T32*ZI
        ZP=T13*XI+T23*YI+T33*ZI
        XPD=T11*DXI+T21*DYI+T31*DZI
        YPD=T12*DXI+T22*DYI+T32*DZI
        ZPD=T13*DXI+T23*DYI+T33*DZI
        TEMP=ATN1F(XP,Y)
        IF*TEMP-3.14159265) 772,772,771
 771    TEMP=TEMP-6.28318530
 772    XGRT=TTI *TEMP
        TEMP2=XP**2+YP**2
        TEMP1=SQRTF(TEMP2)
        YGRT=TEMP1-TTI
        ZGRT=ZP
        CGAMT=COSF(GAMT)
        XGRTD=TTI *(YP*XPD-XP*YPD)/TEMP2+RADTD*TEMP+TVM *CGAMT
        YGRTD=-RADTD+(XP*XPD+YP*YPD)/TEMP1
        ZGRTD=ZPD
 920    CONTINUE
        PHIBS =PHIB
        THBS  =THETAB
        PSIBS =PSIB
        TRIS  =TRI
        SRAAS =SRAA
        SREAS =SREA
        IF (LFT) 421,420,421
 421    FXP =FXP +FXPSV
        FYP =FYP +FYPSV
        FZP =FZP +FZPSV
        FXPS=FXP
        FYPS=FYP
        FZPS=FZP
        CALL QUANT (FXP,.11)
        CALL QUANT (FYP,.11)
        CALL QUANT (FZP,.11)
        FXPSP=FXP
        FYPSP=FYP
        FZPSP=FZP
C
C       FROM PAGE 77 OF THE REPORT 

C
C       FROM PAGE 78 OF THE REPORT 

C
C       FROM PAGE 79 OF THE REPORT 

C
C       FROM PAGE 80 OF THE REPORT 

C
C       FROM PAGE 81 OF THE REPORT 

C
C       FROM PAGE 82 OF THE REPORT 

C
C       FROM PAGE 83 OF THE REPORT 

C
C       FROM PAGE 84 OF THE REPORT 

C
C       FROM PAGE 85 OF THE REPORT 

        RETURN
        END(1,1,0,0,0,0,1,1,0,0,0,0,0,0,0)
